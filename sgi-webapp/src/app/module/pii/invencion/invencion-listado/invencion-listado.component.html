<sgi-menu-content>
  <!-- Buscador de invenciones -->
  <form class="formulario mat-elevation-z8" [formGroup]=" formGroup" [fxLayout.xs]="fxLayoutProperties.xs"
    [fxLayout]="fxLayoutProperties.layout" [fxLayoutGap]="fxLayoutProperties.gap" ngClass.gt-xs="ml-10">

    <div fxFlex="95%" fxFlex.sm="50%" fxFlex.md="73%" [fxLayout.xs]="fxLayoutProperties.xs"
      [fxLayout]="fxLayoutProperties.layout" [fxLayoutGap]="fxLayoutProperties.gap" ngClass.gt-xs="ml-10">

      <!-- Nº de invención-->
      <div [fxFlex.sm]="fxFlexProperties.sm" [fxFlex.md]="fxFlexProperties.md" [fxFlex.gt-md]="fxFlexProperties.gtMd"
        [fxFlexOrder]="fxFlexProperties.order">
        <mat-form-field>
          <mat-label>{{'pii.invencion.numero-invencion' | translate}}</mat-label>
          <input matInput placeholder="{{'pii.invencion.numero-invencion' | translate}}" formControlName="id">
        </mat-form-field>
      </div>

      <!-- Fecha de Comunicación Desde -->
      <div [fxFlex.sm]="fxFlexProperties.sm" [fxFlex.md]="fxFlexProperties.md" [fxFlex.gt-md]="fxFlexProperties.gtMd"
        [fxFlexOrder]="fxFlexProperties.order">
        <mat-form-field class=" input-form">
          <mat-label>{{'pii.invencion.fecha-comunicacion-desde' | translate}}</mat-label>
          <input matInput formControlName="fechaComunicacionDesde" [matDatepicker]="fechaComunicacionDesde">
          <mat-datepicker-toggle matSuffix [for]="fechaComunicacionDesde"></mat-datepicker-toggle>
          <mat-datepicker #fechaComunicacionDesde></mat-datepicker>
        </mat-form-field>
      </div>

      <!-- Fecha de Comunicacion Hasta -->
      <div [fxFlex.sm]="fxFlexProperties.sm" [fxFlex.md]="fxFlexProperties.md" [fxFlex.gt-md]="fxFlexProperties.gtMd"
        [fxFlexOrder]="fxFlexProperties.order">
        <mat-form-field class="input-form" sgiEndDate>
          <mat-label>{{'pii.invencion.fecha-comunicacion-hasta' | translate}}</mat-label>
          <input matInput formControlName="fechaComunicacionHasta" [matDatepicker]="fechaComunicacionHasta">
          <mat-datepicker-toggle matSuffix [for]="fechaComunicacionHasta"></mat-datepicker-toggle>
          <mat-datepicker #fechaComunicacionHasta></mat-datepicker>
        </mat-form-field>
      </div>

      <!-- Tipo de Protección -->
      <div [fxFlex.sm]="fxFlexProperties.sm" [fxFlex.md]="fxFlexProperties.md" [fxFlex.gt-md]="fxFlexProperties.gtMd"
        [fxFlexOrder]="fxFlexProperties.order">
        <mat-form-field class="input-form">
          <mat-label>{{'pii.invencion.tipo-proteccion' | translate}}</mat-label>
          <sgi-select-entity formControlName="tipoProteccion" [options]=" tiposProteccion$ | async">
          </sgi-select-entity>
        </mat-form-field>
      </div>

      <!-- Sector de Aplicación -->
      <div [fxFlex.sm]="fxFlexProperties.sm" [fxFlex.md]="fxFlexProperties.md" [fxFlex.gt-md]="fxFlexProperties.gtMd"
        [fxFlexOrder]="fxFlexProperties.order">
        <mat-form-field class="input-form">
          <mat-label>{{'pii.sector-aplicacion' | translate:MSG_PARAMS.CARDINALIRY.SINGULAR}}</mat-label>
          <sgi-select-entity formControlName="sectorAplicacion" [options]=" sectoresAplicacion$ | async">
          </sgi-select-entity>
        </mat-form-field>
      </div>
    </div>

    <div fxFlex="95%" fxFlex.sm="50%" fxFlex.md="73%" [fxLayout.xs]="fxLayoutProperties.xs"
      [fxLayout]="fxLayoutProperties.layout" [fxLayoutGap]="fxLayoutProperties.gap" ngClass.gt-xs="ml-10">

      <!--Título-->
      <div [fxFlex.sm]="fxFlexProperties50.sm" [fxFlex.md]="fxFlexProperties50.md"
        [fxFlex.gt-md]="fxFlexProperties50.gtMd" [fxFlexOrder]="fxFlexProperties.order">
        <mat-form-field>
          <mat-label>{{'pii.invencion.titulo' | translate}}</mat-label>
          <input matInput placeholder="{{'pii.invencion.titulo' | translate}}" formControlName="titulo">
        </mat-form-field>
      </div>

      <!--Persona-->
      <div [fxFlex.sm]="fxFlexProperties50.sm" [fxFlex.md]="fxFlexProperties50.md"
        [fxFlex.gt-md]="fxFlexProperties50.gtMd" [fxFlexOrder]="fxFlexProperties.order">
        <mat-form-field>
          <mat-label>{{'pii.invencion.inventor' | translate}}</mat-label>
          <sgi-select-persona placeholder="{{'pii.invencion.inventor' | translate}}" formControlName="inventor"
            [tipoColectivo]="TipoColectivo.AUTOR_INVENCION">
          </sgi-select-persona>
        </mat-form-field>
      </div>

    </div>

    <!-- Búsqueda Avanzada -->
    <ng-container *ngIf="isBusquedaAvanzada">
      <!-- Palabras clave -->
      <div fxFlex="100%">
        <mat-form-field fxFill>
          <mat-label>{{'pii.invencion.palabras-clave' | translate}}</mat-label>
          <sgi-palabra-clave formControlName="palabrasClave" id="palabrasClave"
            placeholder="{{'pii.invencion.palabras-clave' | translate}}"></sgi-palabra-clave>
        </mat-form-field>
      </div>


      <div fxFlex="100%">
        <h3>{{'pii.invencion.busqueda.titulo-avanzada' | translate}}</h3>
      </div>
      <div id="column1" fxFlex fxFlex.sm="100%" fxFlex.lt-md="50%" fxLayout="column" fxLayoutGap="10px" fxGrow="0">
        <!-- Nº de Solicitud-->
        <div>
          <mat-form-field>
            <mat-label>{{'pii.solicitud-proteccion.numero-solicitud' | translate}}</mat-label>
            <input matInput placeholder="{{'pii.solicitud-proteccion.numero-solicitud' | translate}}"
              formControlName="solicitudNumero">
          </mat-form-field>
        </div>
        <!-- Filtro Vía de Protección -->
        <div>
          <mat-form-field>
            <mat-label>{{'pii.solicitud-proteccion.via-proteccion' | translate}}</mat-label>
            <sgi-select-entity formControlName="solicitudViaProteccion" [options]="viasProteccion$ | async">
            </sgi-select-entity>
          </mat-form-field>
        </div>
      </div>

      <div id="column2" fxFlex fxFlex.sm="100%" fxFlex.lt-md="50%" fxLayout="column" fxLayoutGap="10px">
        <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="10px">
          <!-- Fecha de Solicitud Desde -->
          <div fxFlex>
            <mat-form-field class="input-form">
              <mat-label>{{'pii.solicitud-proteccion.fecha-solicitud-desde' | translate}}</mat-label>
              <input matInput formControlName="solicitudInicioFechaDesde" [matDatepicker]="solicitudInicioFechaDesde">
              <mat-datepicker-toggle matSuffix [for]="solicitudInicioFechaDesde"></mat-datepicker-toggle>
              <mat-datepicker #solicitudInicioFechaDesde></mat-datepicker>
            </mat-form-field>
          </div>
          <!-- Fecha de Solicitud Hasta -->
          <div fxFlex>
            <mat-form-field class="input-form" sgiEndDate>
              <mat-label>{{'pii.solicitud-proteccion.fecha-solicitud-hasta' | translate}}</mat-label>
              <input matInput formControlName="solicitudInicioFechaHasta" [matDatepicker]="solicitudInicioFechaHasta">
              <mat-datepicker-toggle matSuffix [for]="solicitudInicioFechaHasta"></mat-datepicker-toggle>
              <mat-datepicker #solicitudInicioFechaHasta></mat-datepicker>
            </mat-form-field>
          </div>
        </div>
        <!-- Filtro Pais -->
        <div fxFlex="100%" *ngIf="showFiltroPais$| async">
          <mat-form-field fxFill>
            <mat-label>{{'pii.solicitud-proteccion.pais' | translate}}</mat-label>
            <sgi-select-entity formControlName="solicitudPais" [options]="paises$ | async">
            </sgi-select-entity>
          </mat-form-field>
        </div>
      </div>

      <div id="column3" fxFlex fxFlex.sm="100%" fxFlex.lt-md="100%" fxLayout="column" fxLayoutGap="10px">
        <!-- Filtro Título-->
        <div fxFlex="100%">
          <mat-form-field>
            <mat-label>{{'pii.solicitud-proteccion.titulo' | translate}}</mat-label>
            <input matInput placeholder="{{'pii.invencion.titulo' | translate}}" formControlName="solicitudTitulo">
          </mat-form-field>
        </div>
        <div fxFLex fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="10px">
          <div fxFlex fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="10px">
            <!-- Fecha Fin de Prioridad Desde -->
            <div fxFlex>
              <mat-form-field class="input-form">
                <mat-label>{{'pii.solicitud-proteccion.fecha-fin-prioridad-desde' | translate}}</mat-label>
                <input matInput formControlName="solicitudFinFechaDesde" [matDatepicker]="solicitudFinFechaDesde">
                <mat-datepicker-toggle matSuffix [for]="solicitudFinFechaDesde"></mat-datepicker-toggle>
                <mat-datepicker #solicitudFinFechaDesde></mat-datepicker>
              </mat-form-field>
            </div>
            <!-- Fecha Fin de Prioridad  Hasta -->
            <div fxFlex>
              <mat-form-field class="input-form" sgiEndDate>
                <mat-label>{{'pii.solicitud-proteccion.fecha-fin-prioridad-hasta' | translate}}</mat-label>
                <input matInput formControlName="solicitudFinFechaHasta" [matDatepicker]="solicitudFinFechaHasta">
                <mat-datepicker-toggle matSuffix [for]="solicitudFinFechaHasta"></mat-datepicker-toggle>
                <mat-datepicker #solicitudFinFechaHasta></mat-datepicker>
              </mat-form-field>
            </div>
          </div>
          <!-- Estado Solicitud Protección -->
          <div fxFlex>
            <mat-form-field>
              <mat-label>{{'pii.solicitud-proteccion.estado' | translate}}</mat-label>
              <sgi-select-enum formControlName="solicitudEstado" [enumMap]="ESTADO_SOLICITUD_PROTECCION_MAP">
              </sgi-select-enum>
            </mat-form-field>
          </div>
        </div>

      </div>
    </ng-container>

    <div fxFlex="100%" class="buttons-final">
      <div class="col filter-button">
        <button color="primary" aria-label="Center Align" mat-raised-button (click)="onSearch()">
          <mat-icon>search</mat-icon> {{'btn.search'| translate}}
        </button>
        <button class="link-busqueda underline" aria-label="Center Align" mat-button (click)="toggleBusquedaAvanzada()">
          {{(isBusquedaAvanzada ? 'btn.search.simple' : 'btn.search.advanced')| translate}}
        </button>
        <button color="warn" aria-label="Center Align" (click)="onClearFilters()" mat-button>{{'btn.clean'|
          translate}}
        </button>
      </div>
    </div>
  </form>
  <!-- FIN Buscador de invenciones -->

  <!-- Listado de invenciones -->
  <div class="mat-elevation-z4">
    <table mat-table [dataSource]="invencion$ | async" matSort matSortActive="id" matSortDirection="desc"
      matSortDisableClear>
      <!-- Nº de Invención -->
      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> {{'pii.invencion.numero-invencion' | translate}}
        </th>
        <td mat-cell *matCellDef="let invencion">{{invencion.id}}</td>
      </ng-container>

      <!-- Fecha comunicación -->
      <ng-container matColumnDef="fechaComunicacion">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> {{'pii.invencion.fecha-comunicacion' | translate}}
        </th>
        <td mat-cell *matCellDef="let invencion">{{invencion.fechaComunicacion | luxon:'shortDate'}}</td>
      </ng-container>

      <!--Título-->
      <ng-container matColumnDef="titulo">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          {{'pii.invencion.titulo' | translate}}
        </th>
        <td mat-cell *matCellDef="let invencion">
          {{invencion.titulo}}</td>
      </ng-container>

      <!--Tipo de protección-->
      <ng-container matColumnDef="tipoProteccion.nombre">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          {{'pii.invencion.tipo-proteccion' | translate}}
        </th>
        <td mat-cell *matCellDef="let invencion">
          {{invencion.tipoProteccion?.padre?.nombre || invencion.tipoProteccion?.nombre}}</td>
      </ng-container>

      <!-- Activo -->
      <ng-container matColumnDef="activo">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> {{'label.activo' | translate}}
        </th>
        <td mat-cell *matCellDef="let invencion">
          {{(invencion.activo ? 'label.si' : 'label.no') | translate}}
        </td>
      </ng-container>

      <!-- Acciones -->
      <ng-container matColumnDef="acciones">
        <th mat-header-cell *matHeaderCellDef> {{'label.actions' | translate}} </th>
        <td mat-cell *matCellDef="let invencion">
          <ng-container *sgiHasAnyAuthority="['PII-INV-E', 'PII-INV-V']">
            <a *ngIf="invencion.activo" mat-button matTooltip="{{'btn.edit' | translate}}"
              [routerLink]="[invencion.id]">
              <mat-icon color="primary">border_color</mat-icon>
            </a>
          </ng-container>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="columnas"></tr>
      <tr mat-row *matRowDef="let row; columns: columnas;"></tr>
    </table>
    <mat-paginator [pageSizeOptions]="elementosPagina" [length]="totalElementos" showFirstLastButtons>
    </mat-paginator>
  </div>
  <sgi-menu-content-footer *sgiHasAuthority="'PII-INV-C'">
    <sgi-footer-crear [texto]="textoCrear" [route]="ROUTE_NAMES.NEW">
    </sgi-footer-crear>
  </sgi-menu-content-footer>
</sgi-menu-content>