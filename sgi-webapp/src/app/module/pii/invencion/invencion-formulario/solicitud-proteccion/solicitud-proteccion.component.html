<sgi-fragment title="{{'menu.pii.invenciones.solicitudes-proteccion' | translate}}">

  <div class="mat-elevation-z4">
    <table mat-table [dataSource]="dataSource" matSort matSortActive="viaProteccion.nombre" matSortDirection="asc"
      matSortDisableClear>

      <!-- Via Proteccion -->
      <ng-container matColumnDef="viaProteccion.nombre">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          {{'pii.solicitud-proteccion.via-proteccion' | translate}}
        </th>
        <td mat-cell *matCellDef="let solicitudprot">
          {{ solicitudprot?.viaProteccion.nombre }}
        </td>
      </ng-container>

      <!-- Fecha Fin Prioridad -->
      <ng-container matColumnDef="fechaFinPriorPresFasNacRec">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          {{'pii.solicitud-proteccion.fecha-fin-prioridad' | translate}}
        </th>
        <td mat-cell *matCellDef="let solicitudprot">
          {{ solicitudprot?.fechaFinPriorPresFasNacRec | luxon:'shortDate'}}
        </td>
      </ng-container>

      <!-- Fecha Solicitud -->
      <ng-container matColumnDef="fechaPrioridadSolicitud">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          {{'pii.solicitud-proteccion.fecha-solicitud' | translate}}
        </th>
        <td mat-cell *matCellDef="let solicitudprot">
          {{ solicitudprot?.fechaPrioridadSolicitud | luxon:'shortDate'}}
        </td>
      </ng-container>

      <!-- Numero Solicitud -->
      <ng-container matColumnDef="numeroSolicitud">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          {{'pii.solicitud-proteccion.numero-solicitud' | translate}}
        </th>
        <td mat-cell *matCellDef="let solicitudprot">
          {{ solicitudprot?.numeroSolicitud}}
        </td>
      </ng-container>

      <!-- Numero Publicacion -->
      <ng-container matColumnDef="numeroPublicacion">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          {{'pii.solicitud-proteccion.numero-publicacion' | translate}}
        </th>
        <td mat-cell *matCellDef="let solicitudprot">
          {{ solicitudprot?.numeroPublicacion}}
        </td>
      </ng-container>

      <!-- Numero Concesion -->
      <ng-container matColumnDef="numeroConcesion">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          {{'pii.solicitud-proteccion.numero-concesion' | translate}}
        </th>
        <td mat-cell *matCellDef="let solicitudprot">
          {{ solicitudprot?.numeroConcesion}}
        </td>
      </ng-container>

      <!-- Numero Registro -->
      <ng-container matColumnDef="numeroRegistro">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          {{'pii.solicitud-proteccion.numero-registro' | translate}}
        </th>
        <td mat-cell *matCellDef="let solicitudprot">
          {{ solicitudprot?.numeroRegistro}}
        </td>
      </ng-container>

      <!-- Estado -->
      <ng-container matColumnDef="estado">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          {{'pii.solicitud-proteccion.estado' | translate}}
        </th>
        <td mat-cell *matCellDef="let solicitudprot">
          {{ ESTADO_MAP.get(solicitudprot?.estado) | translate }}
        </td>
      </ng-container>

      <!-- Activo -->
      <ng-container matColumnDef="activo">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> {{'label.activa' | translate}}
        </th>
        <td mat-cell *matCellDef="let solicitudprot">{{(solicitudprot?.activo ? 'label.si' : 'label.no') |
          translate}}
        </td>
      </ng-container>

      <!-- Acciones -->
      <ng-container matColumnDef="acciones">
        <th mat-header-cell *matHeaderCellDef> {{'label.actions' | translate}} </th>
        <td mat-cell *matCellDef="let solicitudprot; let row = index;">
          <ng-container *sgiHasAuthority="'PII-INV-E'">
            <button *ngIf="solicitudprot?.activo" mat-button matTooltip="{{'btn.edit' | translate}}">
              <mat-icon color="primary">border_color</mat-icon>
            </button>
          </ng-container>
          <ng-container *sgiHasAuthority="'PII-INV-E'">
            <button *ngIf="solicitudprot?.activo" mat-button matTooltip="{{'btn.delete' | translate}}"
              (click)="deactivateSolicitudProteccion(solicitudprot, row)">
              <mat-icon color="warn">highlight_off</mat-icon>
            </button>
          </ng-container>
          <ng-container *sgiHasAuthority="'PII-INV-E'">
            <button *ngIf="!solicitudprot?.activo" mat-button matTooltip="{{'btn.recover' | translate}}"
              (click)="activateSolicitudProteccion(solicitudprot, row)">
              <mat-icon color="accent">add_circle_outline
              </mat-icon>
            </button>
          </ng-container>

        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="getSuitableColumnsDef(formPart?.invencionTipoPropiedad)">
      </tr>
      <tr mat-row *matRowDef="let row; columns: getSuitableColumnsDef(formPart?.invencionTipoPropiedad);"></tr>
    </table>

    <mat-paginator [pageSizeOptions]="elementosPagina" [length]="totalElementos" showFirstLastButtons>
    </mat-paginator>
  </div>
  <ng-container *sgiHasAuthorityForAnyUO="'PII-INV-E'">
    <div class="separation-button">
      <button color="three" mat-button mat-raised-button [routerLink]="[ROUTE_NAMES.NEW]">
        <mat-icon color="accent">add_circle</mat-icon>
        {{ 'btn.add.entity' | translate:msgParamEntity }}
      </button>
    </div>
  </ng-container>

</sgi-fragment>